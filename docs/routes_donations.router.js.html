<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: routes/donations.router.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: routes/donations.router.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Endpoint documentation for 
 *
 * https://pancreatitis-be.herokuapp.com
 * @module Endpoints
 * 
 */
'use strict'
const router = require('express').Router();

const db = require('../models/donations.model')

/**
 *  Get All Donations
 * @name Donations
 * @path {GET} /donations
 * @auth Will require auth when moving into production
 * @code {200}
 * @response {Array} Donations returns an array of donations
 */
router.get('/',(req,res) => {
    db.getDonations()
      .then(donations =>{
          if(donations){
            return   res.status(200).json({data:donations})
          }
          res.status(404).json({message:"Sorry no donations found"})
      })
      .catch(error =>{res.status(500).json({message:error.message})})
})

/** Get Donations By Id
 * @name Donations
 * @path {GET} /donations/:id
 * @params {Integer} :id is the unique identifier for the donation record
 * @code{200}
 * @response {Object} Donation record
 *
 */
router.get('/:id',(req,res) =>{
    const id = req.params.id
    db.getDonationsById(id)
    .then(donations =>{
        if(donations){
          return  res.status(200).json({data:donations})
        }
        res.status(404).json({message:`Sorry no donations found for id # ${id}`})}
        )
    .catch(error =>{res.status(500).json({message:error.message})})
})

router.get('/byfilter/:filter',(req,res) => {
    const filter = req.params.filter
    db.getDonationsByFilter(filter)
    .then(donations =>{
        if(donations){
          return  res.status(200).json({data:donations})
        }
        return res.status(404).json({message:'Sorry no donations found for those params'})
    })
    .catch(error => {res.status(500).json({message:error.message})})
})

router.post('/',(req,res)=>{
    const donation = req.body
    db.postDonation(donation)
    .then(id =>{
        if(id){
        return res.status(201).json({mesage:`Donation created`,id:id})
        }
      return res.status(409).json({message:'Please make sure all information is entered'})
    })
    .catch(error => {res.status(500).json({message:error.message})})
})

router.put('/:id',(req,res) =>{
    const id = req.params.id
    const changes = req.body
    db.updateDonations(id,changes)
    .then(updates =>{
        if(updates){
            return res.status(200).json({data:updates})
        }
        return res.status(404).json({message:`Sorry no donations found for id# ${id}`})
    })
    .catch(error =>{res.status(500).json({message:error.message})})
})

router.delete('/:id',(req,res) => {
    const id = req.params.id
    db.getDonationsById(id)
     .then(donation =>{
         if(donation[0].id == id){
        return  db.deleteDonation(id)
         .then(deletedDonation =>{
             res.status(204).json(deletedDonation)
         })
     }  return res.status(404).json({message: `Sorry no donation found for id# ${id} `})
         
     })
    .catch(error =>{res.status(500).json({message:error.message})})
})

module.exports = router</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Endpoints.html">Endpoints</a></li></ul><h3>Global</h3><ul><li><a href="global.html#logger">logger</a></li><li><a href="global.html#server">server</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Jan 02 2020 07:18:21 GMT-0800 (PST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
